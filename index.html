

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Quiz</title>
<style>
body {
  text-align: center;
  font-family: sans-serif;
}

img {
  max-width: 90%;
  height: auto;
  margin-top: 20px;
}

button {
  font-size: 20px;
  margin: 10px;
  padding: 10px 20px;
}
</style>
</head>

<body>

<h2 id="progress">Loading...</h2>

<img id="img" src="">

<div>
  <button onclick="answer('distal')">distal</button>
  <button onclick="answer('mesial')">mesial</button>
</div>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbwHCsoQaIbzWGPd5Ft8dAHVV4EWoJwPHtyB5i6rdQWZiqREAjQJsmIw4TgW3-M18GmU/exec";

// ====== 問題作成 ======
const problems = [];

["1distal","1mesial","2distal","2mesial"].forEach(type=>{
  for(let i=1;i<=10;i++){
    problems.push({
      file:`github-dental/${type} (${i}).jpg`,
      answer: type.includes("distal") ? "distal" : "mesial"
    });
  }
});

// ランダム20問
const quiz = problems
  .sort(()=>Math.random()-0.5)
  .slice(0,20);

let current = 0;
let score = 0;

// ====== 次の問題表示 ======
function showNext(){
  if(current >= quiz.length){
    document.body.innerHTML =
      `<h2>終了</h2>
       <p>正答数：${score} / ${quiz.length}</p>`;
    return;
  }

  document.getElementById("img").src = quiz[current].file;
  document.getElementById("progress").innerText =
    `問題 ${current+1} / ${quiz.length}`;
}

// ====== 回答処理 ======
function answer(userAnswer){
  const correct = quiz[current].answer;
  const isCorrect = userAnswer === correct;

  if(isCorrect) score++;

  sendResult(userAnswer, correct, isCorrect);

  current++;
  showNext();
}

// ====== スプレッドシート送信 ======
function sendResult(userAnswer, correct, isCorrect){
  fetch(GAS_URL, {
    method: "POST",
    body: JSON.stringify({
      image: quiz[current].file,
      answer: userAnswer,
      correct: correct,
      result: isCorrect,
      time: new Date().toISOString()
    })
  });
}

showNext();
</script>

</body>
</html>